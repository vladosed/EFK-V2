<source> 
 type tail 
 path /var/log/foo/auth.log 
 pos_file /var/log/auth.pos 
 tag authlog
 format (^\w\w\w) (\d{0,2}) ((\d{0,2})\:(\d{0,2})\:(\d{0,2})) (ip-(\d{0,2})-(\d{0,3})-(\d{0,3})-(\d{0,3})) (\w{0,5}\[\d{0,9}\]):(?<message>.*) 
</source>

<match authlog.**>
 @type elasticsearch
 hosts "ESHOST:PORT"
 logstash_format true
 logstash_prefix "server-authlogs"
 include_tag_key true
 flush_interval 5s
 logstash_dateformat %Y.%m.%d
 time_precision 3
</match>